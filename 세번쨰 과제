# 라이브러리 로드
import numpy as np
import pandas as pd
import statsmodels.api as sm
from sklearn.model_selection import train_test_split   #sklearn.model_selection library 의 train_test_split() 함수를 사용하는 것을 알림.
from sklearn.metrics import mean_squared_error

#데이터 로드 및 확인
data = pd.read_csv("/content/02.야구선수연봉(투수).csv")
print(data.shape)
print(data.info())
print(data.head())

#train/test 데이터셋 분리
train_data, test_data = train_test_split(data, test_size=0.2, random_state=1)

#회귀모델 생성
#모델1
model1 = sm.OLS.from_formula("SALARY_2018 ~ " + " + ".join(train_data.columns.difference(['SALARY_2018'])), data=train_data).fit()
print(model1.summary())

#모델2
model2 = sm.OLS.from_formula("SALARY_2018 ~ VICTORY + DEFEAT + SAVE + WAR", data=train_data).fit()
print(model2.summary())

# 예측
pre_lm = model2.predict(test_data)
result = pd.DataFrame({'actual': test_data['SALARY_2018'], 'predict': pre_lm})
print(result)

# RMSE 계산
import math
rmse_value = math.sqrt(mean_squared_error(test_data['SALARY_2018'], pre_lm))
print("RMSE:", rmse_value)
